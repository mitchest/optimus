<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Mitchell Lyons" />

<meta name="date" content="2017-03-23" />

<title>Optimus workflow</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Optimus workflow</h1>
<h4 class="author"><em>Mitchell Lyons</em></h4>
<h4 class="date"><em>2017-03-23</em></h4>



<p>This vignette outlines a typical workflow that one might use optimus for. Using an ecological example, it shows how optimus can be used for assessment and diagnostics of competing clustering solutions. The workflow includes:</p>
<ul>
<li>find an optimal partitioning solution amoung competing solutions<br />
</li>
<li>identify characteristic species<br />
</li>
<li>refine a classification by merging clusters that increase predictive performance</li>
</ul>
<p>Optimus is built on the premise that a <em>good</em> clustering solution (i.e. a classification) should provide information about the composition and abundance of the multivariate data it is classifying. A natural way to formalize this is with a predictive model, where group membership (clusters) is the predictor, and the multivariate data (site by variables matrix) is the response. optimus uses a multivariate glm framework to fit predictive models, the performance of which inform the classificaiton assessment and diagnostic outputs. The sections below provide further information on the individual componetns of the workflow. Lyons et al. (2016) provides theoretical background, a detailed description of the methodology, and application of the methods on both real and simulated ecological multivariate abundance data.</p>
<div id="supported-data-types" class="section level1">
<h1>Supported data types</h1>
<p>At present, optimus supports the following data types/error distributions:</p>
<ul>
<li>Gaussian (‘normal’ data)<br />
</li>
<li>Negatvie binomial &amp; Poisson (count data)<br />
</li>
<li>Binomial (binary, presense/absence and trials data)<br />
</li>
<li>Ordinal (ordinal, cover-abundance and categorical data)</li>
</ul>
<p>Note that while there is an ecologcial focus to these data exmaples, in a more general sense, this package handle any set of data for i observations of j variables of the above data types. Make sure optimus is loaded at this point.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(optimus)</code></pre></div>
</div>
<div id="finding-an-optimal-partitioning-solution" class="section level1">
<h1>Finding an optimal partitioning solution</h1>
<p>Finding the ‘best’ clustering solution amoung a number of alternatives or competing solutions is a common problem. This problem is the underlying basis of optimus. The <code>find_optimal()</code> function takes one or more clustering solutions and calculates a ‘goodness of fit’ metric for them called sum-of-AIC. Sum-of-AIC is motivated as an estimate of Kullback-Leibler distance, so we posit that the clustering solution that minimises the sum-of-AIC value is the <em>best</em> - simple, but objective and repeatable. Check out <code>?find_optimal</code> to get a feel for the required inputs and expected outputs. The underlying premise is that the clustering solutions are used to predict the multivariate data, so that data is therefore required as an input. We’ll use the <code>?swamps</code> data that comes with optimus.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(swamps)
swamps &lt;-<span class="st"> </span>swamps[,-<span class="dv">1</span>] <span class="co"># get rid of the site ID</span></code></pre></div>
<p>Now we need some clustering solutions to assess. <code>find_optimal()</code> can be supplied with clustering solutions in two different ways: 1) a single object on which the <code>cutree()</code> function can work (this is a common output class for many clustering funcitons in R); or 2) simply a <code>list</code> of clustering solutions. Let’s try the first method.</p>
<div id="find_optimal-using-cutree-method" class="section level2">
<h2>find_optimal() using cutree() method</h2>
<p>We create the cutree-able object with the <code>hclust()</code> and <code>dist()</code> functions - this calculates a distance matrix on the abundance data, and then performs a heirarchical clustering routine.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">swamps_hclust &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="dt">d =</span> <span class="kw">dist</span>(<span class="dt">x =</span> <span class="kw">log1p</span>(swamps), <span class="dt">method =</span> <span class="st">&quot;canberra&quot;</span>),
                        <span class="dt">method =</span> <span class="st">&quot;complete&quot;</span>)</code></pre></div>
<p>Now, this is probably not a particularly smart way of clustering ecological data, but does work without installing any additional packages. You might like to check out the {vegan} and {cluster} packages - for example bray curtis distance (e.g. <code>vegan::vegdist</code>) and flexible-beta clustering (e.g. <code>cluster::agnes</code>) is a popular choice. Moving on, lets now calculate sum-of-AIC using the inbuilt <code>cutree()</code> functionaliy in <code>find_optimal()</code>. Through out optimus, you’ll notice that messeges print to confirm the types of procedures you’re doing, you can turn them off if you like, and I supress them in this vignette</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">swamps_hclust_aics &lt;-<span class="st"> </span><span class="kw">find_optimal</span>(<span class="dt">data =</span> swamps, 
                                   <span class="dt">clustering =</span> swamps_hclust,
                                   <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>,
                                   <span class="dt">cutreeLevels =</span> <span class="dv">2</span>:<span class="dv">40</span>)</code></pre></div>
<p>We pass the original abundance data and the clustering object, and we also specify that a Poisson (negative binomial might be a better choice in reality) error distribution should be used and we want to test clustering solutions with 2 to 40 groups. We can view the results, plot manually from the resulting object, or use the inbuilt plotting function, which plots the results out to an east-to-interpret graph.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(swamps_hclust_aics)</code></pre></div>
<pre><code>##    sum_aic nclusters
## 1 37827.58         2
## 2 36137.12         3
## 3 32577.78         4
## 4 32036.79         5
## 5 31491.49         6
## 6 30012.63         7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(swamps_hclust_aics)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>So we can see from this clustering effort that around 21 clusters is the best solution - after that the predictive performance of the clustering solution does not improve. Now let’s try again, but this time supply a list of clustering solutions.</p>
</div>
<div id="find_optimal-by-supplying-a-list" class="section level2">
<h2>find_optimal() by supplying a list</h2>
<p>Most non-heirarchical clustering functions do not have a <code>cutree()</code> method. If you are passing a list of clustering solutions to <code>find_optimal()</code>, you must ensure that the list elements are a vector of cluster labels that matches the number of rows in the data. Let’s use k-means as an example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">swamps_kmeans &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dt">X =</span> <span class="dv">2</span>:<span class="dv">40</span>,
                        <span class="dt">FUN =</span> function(x, data) {stats::<span class="kw">kmeans</span>(<span class="dt">x =</span> data, <span class="dt">centers =</span> x)$cluster},
                        <span class="dt">data =</span> swamps)</code></pre></div>
<p>This is just a little trick using <code>lapply()</code> that creates a k-means clustering solution for each of 2 to 40 groups, dumping them all into a list. For exmaple, look at the allocation for the 4-group solution</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(swamps_kmeans[[<span class="dv">3</span>]])</code></pre></div>
<pre><code>## 
##  1  2  3  4 
## 15 23 14  2</code></pre>
<p>Now we calculate and plot sum-of-AIC in the same way as before, but pass the list instead.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">swamps_kmeans_aics &lt;-<span class="st"> </span><span class="kw">find_optimal</span>(<span class="dt">data =</span> swamps, 
                                   <span class="dt">clustering =</span> swamps_kmeans,
                                   <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>)
<span class="kw">plot</span>(swamps_kmeans_aics)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>So, similarly to before, it looks like around 20 clusters is again around the optimal solution. It’s nice when that happens! Note that you can just supply a single clustering solution, and the sum-of-AIC will still be calculated. We can utilise the <code>points()</code> method to plot them together too - it works in the same way as <code>plot()</code> on <code>aicsums</code> objects except that it just plots points over the top of a previous plot, so is useful for comparing multiple sets of clustering solutions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(swamps_kmeans_aics)
<span class="kw">points</span>(swamps_hclust_aics, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, 
       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;k-means&quot;</span>, <span class="st">&quot;hclust&quot;</span>), 
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">pch =</span> <span class="dv">16</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>So according to sum-of-AIC, the k-means solutions are all just a bit better. Note also the other possible arguments <code>K=</code> and <code>cutreeOveride=</code> should the need arise.</p>
</div>
</div>
<div id="determining-characteristic-species" class="section level1">
<h1>Determining characteristic species</h1>
<p>Let’s say at this point we have chosen our best classification - say one with 20 clusters, based on the previous exercise. Or perhaps you already have a classification and you just want to calculate characteristic species. <code>get_characteristic()</code> uses the same underlying predictive model framework as <code>find_optimal()</code> except that now we use it to extract the <em>important</em> variables, that is, the ones that the clustering solution has good predictive performance for. In Ecology, this is the process of determining characteristic species, also referred to as diagnostic or indicator species. The heirarchical solution is used here so you should get the same results, but there is a small chance it might be a little different.</p>
<div id="per-cluster-characteristic-species" class="section level2">
<h2>Per-cluster characteristic species</h2>
<p>The first type of characteristic species we will look at is ‘per-cluster’. This means that we will extract a list of characteristic speices for each cluster. Briefly, charactersitic species are defined by the coefficient values that correspond to each level of the clustering solution (remembering that we are fitting models where the data are the responses and the clustering solution is the predictor). Using the data and clustering we have used above, let’s make a solution with 20 clusters and then run <code>get_characteristic()</code> - we need to pass the multivariate data too.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">swamps_20groups &lt;-<span class="st"> </span><span class="kw">cutree</span>(<span class="dt">tree =</span> swamps_hclust, <span class="dt">k =</span> <span class="dv">20</span>)
swamps_char &lt;-<span class="st"> </span><span class="kw">get_characteristic</span>(<span class="dt">data =</span> swamps,
                                  <span class="dt">clustering =</span> swamps_20groups,
                                  <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>,
                                  <span class="dt">type =</span> <span class="st">&quot;per.cluster&quot;</span>)
<span class="kw">print</span>(swamps_char$clusterSolution1)</code></pre></div>
<pre><code>##                     variables coef_value      daic    stderr
## 1        Schoenus.brevifolius  3.1060803 265.19679 0.1221694
## 2  Chorizandra.sphaerocephala  2.8716796 467.93666 0.1373606
## 3       Lepidosperma.limicola  2.6625878 635.59129 0.1524986
## 4             Empodisma.minus  2.6390573 270.99127 0.1543033
## 5          Banksia.ericifolia  2.3353749 341.15909 0.1796053
## 6         Lepidosperma.neesii  2.3025851 564.16069 0.1825742
## 7      Gleichenia.microphylla  2.2686835 706.19536 0.1856953
## 8           Leptocarpus.tenax  2.1202635 293.33741 0.2000000
## 9    Leptospermum.juniperinum  1.4663371 241.78674 0.2773501
## 10          Melaleuca.squamea  1.2992830  80.27894 0.3015113
## 11              Banksia.robur  1.2039728 257.43420 0.3162278
## 12          Hakea.teretifolia  1.0986123 136.69087 0.3333333
## 13         Bauera.microphylla  0.9808293 345.90824 0.3535534
## 14    Leptospermum.squarrosum  0.9808293 405.67603 0.3535534
## 15          Entolasia.stricta  0.8472979 232.03233 0.3779645
## 16          Baeckea.linifolia  0.6931472 290.25843 0.4082483
## 17       Petrophile.pulchella  0.6931472 135.47135 0.4082483
## 18    Xanthorrhoea.resinifera  0.6931472 275.34378 0.4082483
## 19           Xyris.operculata  0.6931472 505.73708 0.4082483
## 20       Dillwynia.floribunda  0.5108256 188.25065 0.4472136</code></pre>
<p><code>get_characteristic(..., pre.cluster=T)</code> returns a list where the elements contain a data frame of characteristic species for each cluster group. Above, we’ve printed out the characteristic species for cluster 1 (the name in the list inherrits from the names in <code>swamps_20groups</code>). The species list is sorted by the size of the coefficient, but it’s dangerous to only consider that, because a big coefficient can sometimes mean a big nothing. So by default the output also includes delta AIC values (eplxained further below) and standard errors. We loosely define that the larger the coefficient (with larger delta AIC values and smaller standard errors guiding <em>significance</em>), the <em>more</em> characteristic that variable (species) is.</p>
<p>Remember the coefficent values might be on a link scale (see Details in <code>?get_characteristic</code>) and that size is not everything. For example, in the characteristic species list we printed out above - the coefficient for cluster 1 has a mean effect of ~22 (<code>exp(3.1060803)</code> because the Poisson GLM uses a log-link) on <em>Schoenus brevifolius</em>; cluster 1 only has a mean effect of ~10 on <em>Gleichenia microphylla</em>, but a much higher delta AIC. So you would have to consider whether you want to put more weight on how big the effect of each cluster is versus how significant it is. It’s a little subjective, but characteristic species analysis usually is - there are probably ecologcial considerations in this example that are important (e.g. <em>S. brevifolius</em> is a fairly widespread sedge, and <em>G. microphylla</em> is a fern with a fairly small range).</p>
</div>
<div id="global-characteristic-species" class="section level2">
<h2>Global characteristic species</h2>
<p>Sometimes we might be interested more generally in the species that are important for a classification, without needing attribution to a particular cluster. In context of model-based approaches, this is actually a more natural way of considering characteristic variables. In an ecological sense, this type of characteristic species might be analgous to ‘high fidelity’ or ‘faithful’ species. This time we just fit the null model and then calculate delta AIC for each species (high values mean more significance). The syntax is as before, except we just modify the <code>type=</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">swamps_20groups &lt;-<span class="st"> </span><span class="kw">cutree</span>(<span class="dt">tree =</span> swamps_hclust, <span class="dt">k =</span> <span class="dv">20</span>)
swamps_char_glob &lt;-<span class="st"> </span><span class="kw">get_characteristic</span>(<span class="dt">data =</span> swamps,
                                       <span class="dt">clustering =</span> swamps_20groups,
                                       <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>,
                                       <span class="dt">type =</span> <span class="st">&quot;global&quot;</span>)
<span class="kw">head</span>(swamps_char_glob, <span class="dv">20</span>)</code></pre></div>
<pre><code>##                        variables     dAIC
## 1              Ptilothrix.deusta 811.5695
## 2         Gleichenia.microphylla 706.1954
## 3          Lepidosperma.limicola 635.5913
## 4            Lepidosperma.neesii 564.1607
## 5             Baumea.teretifolia 546.1552
## 6               Xyris.operculata 505.7371
## 7     Chorizandra.sphaerocephala 467.9367
## 8             Lepyrodia.scariosa 442.8302
## 9           Baloskion.fastigiata 432.3520
## 10             Baeckea.imbricata 420.3051
## 11           Epacris.obtusifolia 414.8919
## 12       Leptospermum.squarrosum 405.6760
## 13 Gymnoschoenus.sphaerocephalus 383.7726
## 14             Lindsaea.linearis 368.5211
## 15            Bauera.microphylla 345.9082
## 16            Banksia.ericifolia 341.1591
## 17             Cassytha.glabella 321.6604
## 18             Almaleea.paludosa 303.3420
## 19             Leptocarpus.tenax 293.3374
## 20             Baeckea.linifolia 290.2584</code></pre>
<p>As a side note, another appraoch would be to use a resampling approach to calculate bootstrapped p-values (e.g. using <code>mvabund::manyglm()</code>) the the significance levels are a bit more exact, but in general delta AIC performs pretty well.</p>
</div>
</div>
<div id="refining-a-classificaiton" class="section level1">
<h1>Refining a classificaiton</h1>
<p>The last part of this workflow is using the sum-of-AIC framework to refine a classificaiton - that is, to merge clusters such that the predictive performance of the model is improved. <code>merge_clusters()</code> will take a clustering solution as a starting point, and then generate all possible pairwise combinations of clusters, fit the models, and then merge the pair with the lowest delta sum-of-AIC value (i.e. the one that least improves the predicitve performance of the classification with respect to the data). So again we need to supply the data, a starting clustering solution, and optionally how many times we want to perform a merge. See <code>?merge_clusters</code> for the defaults. So, going back to our heirarchical clustering solution, let’s start with a higher number of clusters and merge downwards from there.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">swamps_30groups &lt;-<span class="st"> </span><span class="kw">cutree</span>(<span class="dt">tree =</span> swamps_hclust, <span class="dt">k =</span> <span class="dv">30</span>)

swamps_aicmerge &lt;-<span class="st"> </span><span class="kw">merge_clusters</span>(<span class="dt">data =</span> swamps,
                                  <span class="dt">clustering =</span> swamps_30groups,
                                  <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>,
                                  <span class="dt">n.iter =</span> <span class="dv">29</span>)</code></pre></div>
<p><code>merge_clusters()</code> returns a list, where each component is the clustering solution after each iteration (but the first component is the original solution). It will also tell you which clusters were merged in each iteration, but that’s supressed here. It can be slow if there are many clusters, but it gets faster and faster as the numebr of clusters get’s smaller. In this case we merged from 30 clusters down to 2 (29 iterations) to match our previous analyses. New clusters (merges) are given a new cluster label, from {9000, 9001, … n}. For example lets look at the cluster assignments after after 20 iterations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(swamps_aicmerge[[<span class="dv">21</span>]])</code></pre></div>
<pre><code>## 
##   25 9009 9013 9014 9015 9016 9017 9018 9019 9020 
##    3    2    4    6    8    6    6    3    9    7</code></pre>
<p>There’s only one of the original clusters left. Since the object is a list of clustering solutions, we can plug that straight into <code>find_optimal()</code>. Let’s look at how the AIC based merging compares to merging based on the classificaiotn heirarchy (remembering we calculated the sum-of-AICs back in the first section).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">swamps_aicmerge_aics &lt;-<span class="st"> </span><span class="kw">find_optimal</span>(<span class="dt">data =</span> swamps, 
                                     <span class="dt">clustering =</span> swamps_aicmerge,
                                     <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>)

<span class="kw">plot</span>(swamps_aicmerge_aics, <span class="dt">pch =</span> <span class="dv">1</span>)
<span class="kw">points</span>(swamps_hclust_aics, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">pch =</span> <span class="dv">1</span>)
<span class="kw">points</span>(swamps_kmeans_aics, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">pch =</span> <span class="dv">1</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, 
       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;aic-merge&quot;</span>, <span class="st">&quot;k-means&quot;</span>, <span class="st">&quot;hclust&quot;</span>), 
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">pch =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>Note the use of the generic <code>points()</code> function again. Taking it further, you might repeat this exercise with a range of different distance metrics and/or a range of different clustering routines, and plot all of the sum-of-AIC results together. Back to the results - as you might expect, merging based on sum-of-AIC gives as an asymptotic optimum. The results of following the heirarchical classificaiton is reasonably similar to the AIC merging, with around 20 clusters being the optimum. It looks like in this case there might be some deeper splits in the heirarchy that do not allow predicitve performance (based on AIC) to increase steadily; I discuss this more in Lyons et al. (2016). The k-means solution more or less follows the AIC based merging.</p>
</div>
<div id="fin." class="section level1">
<h1>fin.</h1>
<p>So that’s it, optimus in a nutshell. Please give feedback if you have any, and please report bugs - either directly to me or via an issue on github (<a href="https://github.com/mitchest/optimus" class="uri">https://github.com/mitchest/optimus</a>).</p>
<div id="references" class="section level2">
<h2>References</h2>
<p>Lyons et al. 2016. Model-based assessment of ecological community classifications. <em>Journal of Vegetation Science</em>, <strong>27 (4)</strong>: 704–715.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
